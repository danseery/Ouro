<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ouro ‚Äî The Eternal Serpent</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Orbitron:wght@400;600;700;900&display=swap" rel="stylesheet">
</head>
<body>
    <!-- ‚ïê‚ïê‚ïê HEADER ‚ïê‚ïê‚ïê -->
    <header id="game-header">
        <div class="header-title">
            <span class="logo-icon">üêç</span>
            <h1>OURO</h1>
            <span class="subtitle">The Eternal Serpent</span>
        </div>
        <div class="header-right">
            <span id="ascension-badge" class="badge hidden">Ascension <span id="ascension-count">0</span></span>
            <button id="btn-save" class="header-btn" title="Save Game">üíæ</button>
            <button id="btn-collections" class="header-btn" title="Collections">üèÜ</button>
            <button id="btn-guide" class="header-btn" title="Guide">üìñ</button>
            <button id="btn-settings" class="header-btn" title="Settings">‚öô</button>
        </div>
    </header>

    <!-- ‚ïê‚ïê‚ïê EVENT OVERLAY ‚ïê‚ïê‚ïê -->
    <div id="event-overlay" class="hidden">
        <span id="event-text"></span>
        <span id="event-timer"></span>
        <button id="event-action-btn" class="hidden"></button>
    </div>

    <!-- ‚ïê‚ïê‚ïê NOTIFICATION TOAST ‚ïê‚ïê‚ïê -->
    <div id="toast-container"></div>

    <!-- ‚ïê‚ïê‚ïê MAIN GAME AREA ‚ïê‚ïê‚ïê -->
    <main id="game-container">
        <!-- LEFT PANEL: HUD -->
        <section id="hud-panel" class="panel">
            <div class="panel-header" title="Live run status and current resources">Status</div>
            <div class="stat-group">
                <div class="stat">
                    <span class="stat-label" title="Current spendable resource used for upgrades">Essence</span>
                    <span id="hud-essence" class="stat-value essence-glow">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label" title="Essence gained per successful manual bite before temporary event rewards">Per Press</span>
                    <span id="hud-per-press" class="stat-value">1</span>
                </div>
                <div class="stat">
                    <span class="stat-label" title="Passive Essence gained each second while waiting">Idle Income</span>
                    <span id="hud-idle" class="stat-value">0/s</span>
                </div>
            </div>

            <div class="divider"></div>

            <div class="stat-group">
                <div class="stat">
                    <span class="stat-label" title="Current growth stage; fill shed progress to advance">Stage</span>
                    <span id="hud-stage" class="stat-value">Hatchling</span>
                </div>
                <div class="stat">
                    <span class="stat-label" title="Permanent prestige currency kept across runs">Scales</span>
                    <span id="hud-scales" class="stat-value scales-glow">0</span>
                </div>
            </div>

            <div class="divider"></div>

            <div class="stat-group">
                <div class="stat">
                    <span class="stat-label" title="Current combo multiplier affecting Essence gains">Combo</span>
                    <span id="hud-combo" class="stat-value combo-glow">1.0x</span>
                </div>
                <div class="stat">
                    <span class="stat-label" title="Current consecutive successful hits in this combo chain">Hits</span>
                    <span id="hud-hits" class="stat-value">0</span>
                </div>
            </div>

            <div class="divider"></div>

            <!-- Archetype Select -->
            <div class="panel-subheader">Archetype</div>
            <div id="archetype-select" class="archetype-select"></div>

            <div class="divider"></div>

            <!-- Keybinds -->
            <div class="keybinds">
                <span class="kb"><kbd>Space</kbd> Bite</span>
                <span class="kb"><kbd id="kb-buy-range">1-3</kbd> Buy</span>
                <span class="kb"><kbd>S</kbd> Shed</span>
                <span class="kb"><kbd>A</kbd> Ascend</span>
                <span class="kb"><kbd>Z/X/C</kbd> Archetype</span>
                <span class="kb"><kbd>G</kbd> Golden</span>
                <span class="kb"><kbd>B</kbd> Bargain</span>
                <span class="kb"><kbd>E</kbd> Echo</span>
            </div>
        </section>

        <!-- CENTER PANEL: Snake + Rhythm -->
        <section id="center-panel">
            <!-- Snake Display -->
            <div id="snake-display" class="panel">
                <canvas id="snake-art" class="snake-art" width="200" height="200"></canvas>
                <div class="snake-length-heading">LENGTH</div>
                <div id="snake-length-label" class="snake-length">3</div>
                <div class="shed-bar-wrapper">
                    <span id="shed-bar-label" class="shed-bar-label">Next: Hatchling</span>
                    <div class="shed-bar-track">
                        <div id="shed-bar-fill" class="shed-bar-fill" style="width: 0%"></div>
                    </div>
                </div>
            </div>

            <!-- Rhythm Indicator -->
            <div id="rhythm-panel" class="panel">
                <div id="rhythm-jaw" class="jaw-container">
                    <pre id="jaw-top" class="jaw"></pre>
                    <div id="jaw-hint" class="jaw-hint">‚óè wait</div>
                    <pre id="jaw-bottom" class="jaw"></pre>
                </div>
                <div class="feedback-container">
                    <div id="rhythm-feedback" class="feedback"></div>
                </div>
                <div id="rhythm-beat-bar" class="beat-bar-container">
                    <div class="beat-bar-track">
                        <div id="beat-bar-perfect" class="beat-zone perfect-zone"></div>
                        <div id="beat-bar-good" class="beat-zone good-zone"></div>
                        <div id="beat-bar-cursor" class="beat-cursor"></div>
                    </div>
                </div>
                <div class="rhythm-stats">
                    <span id="rhythm-bpm" class="rhythm-stat" title="Target beat tempo">60 target</span>
                    <span id="rhythm-tap-bpm" class="rhythm-stat dim" title="Your recent manual tapping rate">‚Äî rate</span>
                    <span id="rhythm-perfect-streak" class="rhythm-stat dim" title="Current consecutive perfect bites">0 perfect</span>
                    <span id="rhythm-combo-count" class="rhythm-stat dim" title="Current combo chain length">0 combo</span>
                    <span id="rhythm-combo" class="rhythm-stat combo-glow" title="Current combo multiplier">1.0 mult</span>
                </div>
                <div id="rhythm-hint" class="rhythm-hint">‚îÄ‚îÄ bite the tail on the beat ‚îÄ‚îÄ</div>
            </div>

            <!-- Bite Button -->
            <button id="bite-button" class="bite-btn" title="Attempt a bite on-beat (Space or click)">
                <span class="bite-icon">üêç</span>
                <span class="bite-label">BITE</span>
                <span class="bite-sub">Space / Click</span>
            </button>

            <!-- Prestige Info -->
            <div id="prestige-panel" class="panel prestige-panel">
                <div id="prestige-content"></div>
                <div class="prestige-buttons">
                    <button id="btn-shed" class="action-btn shed-btn" disabled title="Reset stage progress to gain Scales and advance to the next stage">
                        <span class="btn-key">S</span> Shed Skin
                    </button>
                    <button id="btn-ascend" class="action-btn ascend-btn" disabled title="Full run reset for permanent ascension progression">
                        <span class="btn-key">A</span> Ascend
                    </button>
                </div>
                <div id="run-stats" class="run-stats"></div>
            </div>
        </section>

        <!-- RIGHT PANEL: Upgrades -->
        <section id="upgrade-panel" class="panel">
            <div class="panel-header">Upgrades</div>
            <div id="upgrade-list" class="upgrade-list">
                <div class="no-offerings">Feed to grow, then offerings appear.</div>
            </div>
        </section>
    </main>

    <!-- ‚ïê‚ïê‚ïê WELCOME MODAL ‚ïê‚ïê‚ïê -->
    <div id="welcome-modal" class="modal-overlay hidden">
        <div class="modal welcome-modal">
            <div class="welcome-snake-glyph">üêç</div>
            <h2 class="welcome-title">You Are the Ouroboros</h2>
            <p class="welcome-flavor">An ancient hunger stirs. Your tail calls to your jaws across the void of time. You are a Snakelet ‚Äî small, new, and endlessly hungry. Bite. Grow. Shed. Repeat. The serpent devours itself so that it may become infinite.</p>

            <div class="welcome-divider"></div>

            <div class="welcome-steps">
                <div class="welcome-step">
                    <div class="welcome-step-icon" style="color:var(--cyan)">‚óé</div>
                    <div class="welcome-step-body">
                        <div class="welcome-step-title">Bite the Beat</div>
                        <div class="welcome-step-desc">Press <kbd>Space</kbd> or tap the <strong>BITE</strong> button in time with the sweeping cursor. Land in the glowing zone for a <strong>Perfect</strong> or the wider area for a <strong>Good</strong>. Missing breaks your rhythm.</div>
                    </div>
                </div>
                <div class="welcome-step">
                    <div class="welcome-step-icon" style="color:var(--purple)">‚ü≥</div>
                    <div class="welcome-step-body">
                        <div class="welcome-step-title">Build Your Combo</div>
                        <div class="welcome-step-desc">Consecutive hits stack a <strong>Combo Multiplier</strong> that amplifies all Essence earned ‚Äî the longer the streak, the higher it climbs. Two misses in a row will shatter it entirely. Don't let the pattern slip.</div>
                    </div>
                </div>
                <div class="welcome-step">
                    <div class="welcome-step-icon" style="color:var(--yellow)">‚óà</div>
                    <div class="welcome-step-body">
                        <div class="welcome-step-title">Grow &amp; Shed</div>
                        <div class="welcome-step-desc">As you grow, the progress bar below your serpent fills. When it's full you can <strong>Shed Skin</strong> (<kbd>S</kbd>) to advance to the next stage and earn Scales ‚Äî permanent currency that carries across runs.</div>
                    </div>
                </div>
                <div class="welcome-step">
                    <div class="welcome-step-icon" style="color:var(--green)">‚¨°</div>
                    <div class="welcome-step-body">
                        <div class="welcome-step-title">Buy Upgrades</div>
                        <div class="welcome-step-desc">Spend Essence on the upgrade offerings in the right panel ‚Äî use the number keys shown on each card. Offerings refresh each time you shed. Upgrades compound ‚Äî buy early, buy often.</div>
                    </div>
                </div>
            </div>

            <div class="welcome-divider"></div>
            <p class="welcome-hint">Open the <strong>üìñ Guide</strong> any time from the header for the full manual.</p>
            <button id="btn-welcome-close" class="welcome-close-btn">Begin Your Coil ‚Üí</button>
            <div class="welcome-toggle-row">
                <label class="pill-toggle">
                    <input id="welcome-hide-toggle" type="checkbox">
                    <span class="toggle-track"></span>
                </label>
                <span class="welcome-toggle-label">Don't show this modal again</span>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê ASCENSION MODAL ‚ïê‚ïê‚ïê -->
    <div id="ascension-modal" class="modal-overlay hidden">
        <div class="modal ascension-modal">
            <h2>‚ú¶ Cosmic Ascension ‚ú¶</h2>
            <p class="modal-desc">Spend Scales on permanent upgrades. Everything else resets.</p>
            <div class="modal-scales">
                Scales: <span id="modal-scales-value">0</span>
            </div>
            <div id="ascension-upgrade-list" class="ascension-list"></div>
            <div class="modal-actions">
                <button id="btn-ascend-confirm" class="action-btn ascend-btn">Confirm Ascension</button>
                <button id="btn-ascend-cancel" class="action-btn">Cancel</button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê SETTINGS MODAL ‚ïê‚ïê‚ïê -->
    <div id="settings-modal" class="modal-overlay hidden">
        <div class="modal settings-modal">
            <div class="settings-header">
                <h2>‚öôÔ∏è Settings</h2>
                <button id="btn-settings-close" class="guide-close-btn">&times;</button>
            </div>
            <div class="settings-content">
                <div class="settings-section">
                    <h3 class="settings-section-title">General</h3>
                    <div class="settings-row">
                        <div>
                            <div class="settings-row-label">Auto-save</div>
                            <div class="settings-row-desc">Game saves automatically every 30 seconds.</div>
                        </div>
                        <label class="pill-toggle" title="Enable automatic save every 30 seconds">
                            <input id="settings-auto-save" type="checkbox" checked>
                            <span class="toggle-track"></span>
                        </label>
                    </div>
                    <div class="settings-row" style="margin-top:10px;">
                        <div>
                            <div class="settings-row-label">Show New Game Modal</div>
                            <div class="settings-row-desc">Show the onboarding modal when starting a fresh early-stage run.</div>
                        </div>
                        <label class="pill-toggle" title="Show or hide the welcome modal on fresh early runs">
                            <input id="settings-show-welcome" type="checkbox" checked>
                            <span class="toggle-track"></span>
                        </label>
                    </div>
                </div>
                <div class="settings-section danger-zone">
                    <h3 class="settings-section-title danger">‚ö†Ô∏è Danger Zone</h3>
                    <div class="settings-row settings-row-top">
                        <div>
                            <div class="settings-row-label">Clear All Save Data</div>
                            <div class="settings-row-desc">Permanently erases your run, meta progress, scales, and ascensions. Cannot be undone.</div>
                        </div>
                        <div id="clear-save-area">
                            <button id="btn-clear-save" class="danger-btn">Clear Save</button>
                            <div id="clear-save-confirm" class="danger-inline-confirm hidden">
                                <div class="danger-inline-warning">‚ö† This cannot be undone.<br>Your serpent will be forgotten.</div>
                                <div class="danger-inline-btns">
                                    <button id="btn-clear-confirm-yes" class="danger-btn-solid">Yes, wipe everything</button>
                                    <button id="btn-clear-confirm-no" class="danger-btn-cancel">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê GUIDE MODAL ‚ïê‚ïê‚ïê -->
    <div id="guide-modal" class="modal-overlay hidden">
        <div class="modal guide-modal">
            <div class="guide-header">
                <h2>Serpent's Guide</h2>
                <button id="btn-guide-close" class="guide-close-btn">&times;</button>
            </div>
            <nav class="guide-tabs">
                <button class="guide-tab active" data-tab="basics">Basics</button>
                <button class="guide-tab" data-tab="upgrades">Upgrades</button>
                <button class="guide-tab" data-tab="events">Events</button>
                <button class="guide-tab" data-tab="archetypes">Archetypes</button>
                <button class="guide-tab" data-tab="debuffs">Debuffs</button>
                <button class="guide-tab" data-tab="ascension">Ascension</button>
            </nav>
            <div id="guide-content" class="guide-content"></div>
        </div>
    </div>

    <!-- Engine must load before game logic -->
    <script src="engine.js"></script>
    <script src="game.js"></script>
</body>
</html>
